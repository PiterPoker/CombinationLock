# Лабораторная работа: Электронный кодовый замок


## Дисциплина: Архитектура высокопроизводительных процессоров


---


**Задание:**


Напишите программу управления электронным кодовым замком на основе микроконтроллера PIC16F84A microcontroller, матричной клавиатуры и одного 7- сегментного индикатора. Открытие замка производится после выполнения пользователем следующих действий:


1. Нажать кнопку “*”, на индикаторе отображается
символ “b”;
2. Ввести 4-символьный идентификатор пользователя;
3. Нажать кнопку “#”, на индикаторе отображается
символ “d”;
4. Ввести 4-символьный правильный пароль.


Замок помнит до 4-х пользователей. По умолчания на индикаторе отображается
символ “A”. При неправильном вводе пароля выводится символ “E”. При
правильном вводе пароля выводится символ “O”. Пароли и идентификаторы
пользователей хранятся в памяти EEPROM микроконтроллера.


**Схема устройства:**


![Image of Yaktocat](https://github.com/PiterPoker/CombinationLock/blob/master/%D1%81ombinationLockScheme.PNG)


**Среда разработки и язык программирования:**


Лабораторная работа выполнена в среде разработке Proteus (v8.5). С использованием языка программирования C. 


**Описание**


При первом запуске программы следует записать логины и пароли в память микро контроллера.


Пример:


``` C++
__EEPROM_DATA('1','4','4','5','6','2','4','1');
__EEPROM_DATA('7','8','5','4','2','2','1','7');
__EEPROM_DATA('0','7','3','2','4','4','1','1');
__EEPROM_DATA('6','5','0','0','9','8','1','1');
```


где первые 4-е цифры это логин пользователя, а последующие 4-е пароль.


Описание разрабонных функций:
1. Функция получения из ПЗУ в ОЗУ логинов и палей:
``` C++
unsigned char* getData(unsigned char* dataUsers, unsigned int address);
```


где __dataUsers__ - массив для записи данных; __address__ - адрес первой ячейки данных в ПЗУ.


Возвращает массив данных.


2. Функция записи данных в массив с клавиатуры:


``` C++
void inputData(unsigned char* arrayInput, int counter, unsigned char getKey);
```


где __arrayInput__ - массив для записи данных с клавиатуры; __counter__ - порядковый номер элементы в массиве; __getKey__ - символ введенный с клавиатуры.


3. Функция сравнения данных массива введенного с клавиатуры и исходных данных:


``` C++
unsigned int compareData(unsigned char* arrayInput, unsigned char* arrayData, unsigned int shift);
```

где __arrayInput__ - массив введенный с клавиатуры; __arrayData__ - массив исходных данных; __shift__ - адресный сдвиг исходного массива.


Возыращает 0 если есби ошибок нет и 1 если есть ошибка.

4. Функция инициализации портов клавиатуры:


``` C++
void InitKeypad(void);
```


5. Функция вычисления ключа нажатой клавиши на клавиатуре:


``` C++
unsigned char KEYPAD_ScanKey(void);
```

возвращает ключ нажатой клавиши.


6. Функция распознания введеного символа с клавиатуры по ключу:



``` C++
unsigned char KEYPAD_GetKey(void);
```


Возвращает введенный символ.


[Перейти к коду...](https://github.com/PiterPoker/CombinationLock/blob/master/main.c)
